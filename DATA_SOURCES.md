# Smart Shift Planner - Data Sources & Population

## Overview
This document explains all data sources, how data is populated, and where each piece of information comes from in the Smart Shift Planner system.

---

## 1. PRIMARY DATA SOURCES

### 1.1 Seed Data (Initial Dataset)
**Location:** `backend/scripts/seed_data.py`

The system uses **synthetic/simulated data** generated during initialization for demonstration and testing purposes.

**Seed Data Components:**

#### Workers Data
- **Source:** Programmatically generated
- **Format:** Python script creates realistic dummy worker records
- **Data Included:**
  - Worker IDs (unique identifiers)
  - Full names
  - Email addresses
  - Role assignments (driver/admin)
  - Password hashes (encrypted)
  - Created timestamps

#### Shift Data
- **Source:** Programmatically generated
- **Format:** Simulated shift patterns
- **Data Included:**
  - Shift dates and times
  - Duration (hours)
  - Worker assignments
  - Shift status (completed/pending/cancelled)
  - Earnings information

#### Survey Data
- **Source:** Programmatically generated
- **Format:** Simulated worker feedback responses
- **Data Included:**
  - Survey questions
  - Worker responses
  - Ratings (1-5 scale)
  - Feedback comments
  - Submission timestamps

#### Eligibility Metrics
- **Source:** Calculated from shift data
- **Format:** Derived metrics
- **Data Included:**
  - Worker eligibility scores
  - Shift guarantee qualifying shifts
  - Income stability metrics
  - Compliance status

---

## 2. RUNTIME DATA SOURCES

### 2.1 User-Generated Data
**How it's created:**

1. **Login/Authentication:**
   - Users log in with demo credentials
   - User data stored in `users` table
   - Session tokens generated (JWT)

2. **Survey Submissions:**
   - Drivers submit feedback through `/dashboard/surveys`
   - API Endpoint: `POST /api/v1/surveys`
   - Data stored in `surveys` table
   - Real-time feedback collection

3. **Admin Actions:**
   - Worker management (create, edit, delete)
   - Admin modifications tracked
   - Changes logged to database

### 2.2 Computed/Derived Data
**Sources of calculated data:**

1. **Volatility Analysis:**
   - **Source:** Shift historical data
   - **Calculation:** Income variance, earnings stability
   - **API:** `GET /api/v1/analytics/volatility`
   - **Storage:** Computed on-demand from shifts table

2. **Model Predictions:**
   - **Source:** ML models trained on shift patterns
   - **Location:** `backend/src/ml/predictors.py`
   - **Data Used:**
     - Historical shift data
     - Worker performance patterns
     - Income trends
   - **Output:** Eligibility predictions, income forecasts

3. **Analytics Metrics:**
   - **Source:** Aggregated database queries
   - **Metrics Include:**
     - Total workers
     - Active shifts
     - Average earnings
     - Completion rates
   - **API:** `GET /api/v1/analytics`

---

## 3. DATABASE SCHEMA & STORAGE

### 3.1 Database Location
- **Database Type:** SQLite (development) / PostgreSQL (production-ready)
- **Location:** `backend/` directory
- **File:** `smart_shift_planner.db` (SQLite)

### 3.2 Data Tables

| Table | Purpose | Data Source |
|-------|---------|-------------|
| `users` | User accounts (workers, admins) | Seed data + Runtime creation |
| `shifts` | Shift records and assignments | Seed data + Runtime tracking |
| `shift_details` | Detailed shift information | Seed data + Runtime updates |
| `surveys` | Worker feedback responses | Runtime submissions |
| `survey_questions` | Survey form templates | Seed data |
| `eligibility_metrics` | Worker eligibility scores | Calculated from shifts |
| `worker_daily_summary` | Daily earnings summaries | Aggregated from shifts |
| `ml_predictions` | ML model predictions | Generated by ML service |

---

## 4. DATA INITIALIZATION PROCESS

### Step 1: Database Creation
```bash
cd backend
python scripts/init_db.py
```
**What happens:**
- Creates database file
- Creates all 8 tables
- Sets up table relationships (foreign keys)
- Creates indexes for performance

### Step 2: Seed Data Population
```bash
python scripts/seed_data.py
```
**What happens:**
- Inserts sample workers (10-20 synthetic workers)
- Inserts sample shifts (100+ synthetic shift records)
- Inserts sample surveys (20-50 survey responses)
- Inserts eligibility metrics

### Step 3: Admin User Creation
```bash
python scripts/seed_admin.py
```
**What happens:**
- Creates admin account
- Credentials: `mykendoche@gmail.com` / `admin123`
- Sets admin privileges
- Stores hashed password

### Step 4: Demo Driver Creation
**What happens:**
- Creates demo driver account
- Credentials: `driver@example.com` / `driver123`
- Links to sample shifts for demonstration

---

## 5. DATA FLOW ARCHITECTURE

```
┌─────────────────────────────────────────────────────────────┐
│                  EXTERNAL DATA SOURCES                       │
│  (Seed Files, User Input, ML Models, Calculations)         │
└──────────────────────┬──────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────────┐
│                   DATABASE LAYER                             │
│  SQLite/PostgreSQL - 8 Tables (users, shifts, surveys, etc) │
└──────────────────────┬──────────────────────────────────────┘
                       │
          ┌────────────┼────────────┐
          ▼            ▼            ▼
┌──────────────┐  ┌─────────────┐  ┌──────────────┐
│  API Server  │  │ ML Service  │  │  Analytics   │
│  (Backend)   │  │  (Python)   │  │  Engine      │
└──────────────┘  └─────────────┘  └──────────────┘
          │            │            │
          └────────────┼────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────────┐
│            FRONTEND (Next.js Dashboard)                      │
│  Login → Dashboard → Analytics/Shifts/Surveys/Reports      │
└─────────────────────────────────────────────────────────────┘
```

---

## 6. SAMPLE DATA AVAILABLE

### Admin Access
- **Email:** `mykendoche@gmail.com`
- **Password:** `admin123`
- **Access:** All system features, worker management, analytics
- **Demo Data:** Full analytics dashboard with seed data

### Driver Access
- **Email:** `driver@example.com`
- **Password:** `driver123`
- **Access:** Personal dashboard, surveys, eligibility, shift insights
- **Demo Data:** Sample shifts, earnings, and survey history

---

## 7. DATA UPDATE MECHANISMS

### 7.1 Real-Time Updates
- **Surveys:** Submitted via `/api/v1/surveys` → Stored in DB
- **Worker Changes:** Admin updates → Stored in `users` table
- **Shift Updates:** Status changes → Stored in `shifts` table

### 7.2 Computed Updates
- **Volatility Analysis:** Calculated on-demand from historical shifts
- **ML Predictions:** Generated when `/api/v1/predictions` is called
- **Analytics Metrics:** Aggregated from database queries

### 7.3 Batch Operations
- **Generate Reports:** Queries multiple tables, generates PDF/JSON
- **Export Data:** Admin can export worker lists, survey results
- **Data Refresh:** Manual refresh of metrics and predictions

---

## 8. DATA VALIDATION & INTEGRITY

### Input Validation
- All API inputs validated before storage
- Email format validation
- Password strength requirements
- Survey response validation (1-5 rating range)

### Data Constraints
- Foreign key relationships enforced
- Unique constraints on emails, IDs
- Not-null constraints on critical fields
- Timestamp auto-generation for audit trail

---

## 9. DATA RETENTION & DELETION

### Current Policy
- **Surveys:** Retained indefinitely (for analysis)
- **Shifts:** Retained for historical analysis
- **Users:** Soft delete (marked as inactive, not removed)
- **Logs:** Activity logs stored for audit trail

### Future Considerations
- Implement data archiving for older records
- Define retention periods per data type
- GDPR compliance for user data deletion

---

## 10. TECHNOLOGY STACK FOR DATA

| Component | Technology | Purpose |
|-----------|-----------|---------|
| Database | SQLite/PostgreSQL | Data persistence |
| ORM | SQLAlchemy | Database abstraction |
| Migrations | Alembic | Schema versioning |
| API | FastAPI | REST endpoints for data |
| Backend Logic | Python | Business logic, calculations |
| Frontend | Next.js/React | Data display and interaction |
| Cache | In-memory | Session management |

---

## 11. HOW TO VERIFY DATA

### Check Database Contents
```bash
# Open SQLite CLI
sqlite3 backend/smart_shift_planner.db

# View all tables
.tables

# View workers
SELECT * FROM users;

# View shifts
SELECT * FROM shifts;

# View surveys
SELECT * FROM surveys;
```

### Check via API
```bash
# Get all analytics
curl http://localhost:8000/api/v1/analytics

# Get worker list (requires admin token)
curl http://localhost:8000/api/v1/workers \
  -H "Authorization: Bearer YOUR_TOKEN"

# Get survey data
curl http://localhost:8000/api/v1/surveys
```

### Check via Frontend
1. Navigate to `http://localhost:3000/login`
2. Login with demo credentials
3. View data in respective dashboards
4. Data comes from `/api/v1/*` endpoints

---

## 12. DATA PIPELINE SUMMARY

| Stage | Source | Process | Output |
|-------|--------|---------|--------|
| **Ingestion** | Seed scripts | Python generates data | Database tables populated |
| **Storage** | SQLite DB | Data persistence | ACID compliance |
| **Processing** | Backend API | Query, filter, aggregate | JSON responses |
| **Analysis** | ML Service | Train models, predictions | Accuracy metrics, forecasts |
| **Visualization** | Frontend | Render data as UI | Charts, tables, insights |
| **Export** | Admin dashboard | Generate reports | PDF, CSV downloads |

---

## 13. CURRENT DATA SAMPLE SIZES

Based on seed data configuration:

- **Users:** ~12-15 total (10 drivers, 1 admin, 1 demo driver)
- **Shifts:** ~100-150 synthetic shift records
- **Surveys:** ~30-50 survey responses
- **Eligibility Metrics:** Calculated per worker
- **Daily Summaries:** 100+ aggregated records

---

## 14. FUTURE DATA SOURCES (PLANNED)

- Integration with real-world shift management systems
- Live worker time-tracking data
- Real earnings and payment data
- Actual survey responses from real workers
- Real ML model training on production data
- Integration with payment processors
- Real-time location tracking (optional)

---

## Summary

**In Answer to "Where is the source of the data?":**

1. **Initial Data:** Synthetic seed data from `backend/scripts/seed_data.py`
2. **User Data:** Created via admin registration and demo accounts
3. **Runtime Data:** Generated by user actions (surveys, worker updates)
4. **Computed Data:** Calculated from historical shifts via ML models and analytics
5. **Storage:** SQLite/PostgreSQL database with 8 related tables
6. **Access:** Via FastAPI REST endpoints and Next.js frontend
7. **Verification:** Check via SQLite CLI, API calls, or dashboard UI

The system is **fully functional with synthetic data** for demonstration and testing. It's ready to scale with real data when connected to actual shift management systems.

---

**Document Version:** 1.0  
**Last Updated:** February 13, 2026  
**Status:** Complete
